{"title":"UE5腾讯语音插件","uid":"ba6fb44dc0401888063830fe3b00965d","slug":"7_22_UE5腾讯语音插件","date":"2024-03-03T07:08:21.397Z","updated":"2024-03-03T07:08:53.482Z","comments":true,"path":"api/articles/7_22_UE5腾讯语音插件.json","keywords":null,"cover":"https://cdn.jsdelivr.net/gh/FHangH/FHangBlogCDN_03@master/Aurora_ (44).webp","content":"<h1 id=\"UE5腾讯语音插件\"><a href=\"#UE5腾讯语音插件\" class=\"headerlink\" title=\"UE5腾讯语音插件\"></a>UE5腾讯语音插件</h1><p>[toc]</p>\n<h3 id=\"0-github\"><a href=\"#0-github\" class=\"headerlink\" title=\"0. github\"></a>0. github</h3><p>里面动态库太大了，暂时没传github；</p>\n<p>腾讯语音 <a href=\"https://www.alipan.com/s/YQ8AJm7VVoo\">https://www.alipan.com/s/YQ8AJm7VVoo</a> 提取码: 2dg0</p>\n<h3 id=\"1-SDK接口\"><a href=\"#1-SDK接口\" class=\"headerlink\" title=\"1. SDK接口\"></a>1. SDK接口</h3><p>插件使用的腾讯GME提供的全平台SDK，先用原生C++定义接口，再用UE C++ Subsystem接入到蓝图中</p>\n<p><code>GMEAudioAdpter.h</code></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">pragma</span> once</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;tmg_sdk.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;CoreMinimal.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">ITMGMessage</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">\t<span class=\"keyword\">virtual</span> ~<span class=\"built_in\">ITMGMessage</span>() &#123;&#125;;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">virtual</span> <span class=\"type\">void</span> <span class=\"title\">OnMessage</span><span class=\"params\">(<span class=\"type\">const</span> FString&amp; message)</span> </span>= <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> SEND_MESSAGE(message) <span class=\"keyword\">if</span> (nullptr != MessageHandler) &#123; \\</span></span><br><span class=\"line\"><span class=\"meta\">\tMessageHandler-&gt;OnMessage(message);\t\t\t\t\t\t\t\\</span></span><br><span class=\"line\"><span class=\"meta\">&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">GMEAudioAdpter</span> : <span class=\"keyword\">public</span> ITMGDelegate</span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">\t<span class=\"type\">static</span> GMEAudioAdpter* Ins;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">static</span> GMEAudioAdpter* <span class=\"title\">Get</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"><span class=\"keyword\">protected</span>:</span><br><span class=\"line\">\t<span class=\"built_in\">GMEAudioAdpter</span>();</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">virtual</span> <span class=\"type\">void</span> <span class=\"title\">OnEvent</span><span class=\"params\">(ITMG_MAIN_EVENT_TYPE eventType, <span class=\"type\">const</span> <span class=\"type\">char</span>* data)</span> <span class=\"keyword\">override</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">SetMessageHandler</span><span class=\"params\">(ITMGMessage* handler)</span></span>;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">SetUserID</span><span class=\"params\">(<span class=\"type\">const</span> FString&amp; pUserID)</span></span>;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">StartRecord</span><span class=\"params\">()</span> <span class=\"type\">const</span></span>;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">StartRecordingWithStreaming</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">StopRecord</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">CancelRecord</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">Upload</span><span class=\"params\">()</span> <span class=\"type\">const</span></span>;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">Download</span><span class=\"params\">()</span> <span class=\"type\">const</span></span>;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">Play</span><span class=\"params\">()</span> <span class=\"type\">const</span></span>;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">ConvertToText</span><span class=\"params\">()</span> <span class=\"type\">const</span></span>;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">InitGME</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">UnInit</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">OnTickGME</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\"><span class=\"keyword\">private</span>:</span><br><span class=\"line\">\t<span class=\"function\">FString <span class=\"title\">GetFilePath</span><span class=\"params\">()</span> <span class=\"type\">const</span></span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\"><span class=\"keyword\">private</span>:</span><br><span class=\"line\">\tITMGMessage* MessageHandler;</span><br><span class=\"line\">\tFString UserID;</span><br><span class=\"line\">\tFString FilePath;</span><br><span class=\"line\">\tFString FileUrl;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">\tFString STT;</span><br><span class=\"line\">\tFString SdkAppID;</span><br><span class=\"line\">\tFString SdkAppKey;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n\n\n<p><code>GMEAudioAdpter.cpp</code></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;GMEAudioAdpter.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;string&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;Containers/StringConv.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;Dom/JsonObject.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;Engine/Engine.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;Misc/Paths.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;Serialization/JsonReader.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;Serialization/JsonSerializer.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;Templates/SharedPointer.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">GMEAudioAdpter* GMEAudioAdpter::Ins = <span class=\"literal\">nullptr</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">GMEAudioAdpter* <span class=\"title\">GMEAudioAdpter::Get</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (<span class=\"literal\">nullptr</span> == Ins)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tIns = <span class=\"keyword\">new</span> GMEAudioAdpter;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> Ins;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">GMEAudioAdpter::<span class=\"built_in\">GMEAudioAdpter</span>() : <span class=\"built_in\">MessageHandler</span>(<span class=\"literal\">nullptr</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">GMEAudioAdpter::OnEvent</span><span class=\"params\">(ITMG_MAIN_EVENT_TYPE eventType, <span class=\"type\">const</span> <span class=\"type\">char</span>* data)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tFString jsonData = <span class=\"built_in\">FString</span>(<span class=\"built_in\">UTF8_TO_TCHAR</span>(data));</span><br><span class=\"line\">\tTSharedPtr&lt;FJsonObject&gt; JsonObject;</span><br><span class=\"line\">\t<span class=\"type\">const</span> TSharedRef&lt;TJsonReader&lt;&gt;&gt; Reader = TJsonReaderFactory&lt;&gt;::<span class=\"built_in\">Create</span>(<span class=\"built_in\">FString</span>(<span class=\"built_in\">UTF8_TO_TCHAR</span>(data)));</span><br><span class=\"line\">\tFJsonSerializer::<span class=\"built_in\">Deserialize</span>(Reader, JsonObject);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">if</span> PLATFORM_ANDROID || PLATFORM_IOS || PLATFORM_WINDOWS || PLATFORM_MAC</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (eventType == ITMG_MAIN_EVNET_TYPE_PTT_RECORD_COMPLETE)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tSTT = <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">\t\tFileUrl = <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">\t\t<span class=\"type\">const</span> int32 result = JsonObject-&gt;<span class=\"built_in\">GetIntegerField</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;result&quot;</span>));</span><br><span class=\"line\">\t\tFilePath = JsonObject-&gt;<span class=\"built_in\">GetStringField</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;file_path&quot;</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"type\">const</span> std::string path = <span class=\"built_in\">TCHAR_TO_UTF8</span>(FilePath.<span class=\"keyword\">operator</span>*());</span><br><span class=\"line\">\t\t<span class=\"type\">int</span> duration = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"type\">int</span> filesize = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (result == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tduration = <span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">GetPTT</span>()-&gt;<span class=\"built_in\">GetVoiceFileDuration</span>(path.<span class=\"built_in\">c_str</span>());</span><br><span class=\"line\">\t\t\tfilesize = <span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">GetPTT</span>()-&gt;<span class=\"built_in\">GetFileSize</span>(path.<span class=\"built_in\">c_str</span>());</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"type\">const</span> FString msg = FString::<span class=\"built_in\">Printf</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;info: recording completed.\\nreslut=%d\\nfilepath=%ls\\nduarion=%.2f\\nfilesize=%.2fKB&quot;</span>), result, *FilePath, duration / <span class=\"number\">1000.0f</span>, filesize / <span class=\"number\">1024.0f</span>);</span><br><span class=\"line\">\t\t<span class=\"built_in\">SEND_MESSAGE</span>(msg)</span><br><span class=\"line\">\t\t<span class=\"built_in\">UE_LOG</span>(LogTemp, Warning, <span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;%s&quot;</span>), *msg);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (eventType == ITMG_MAIN_EVNET_TYPE_PTT_UPLOAD_COMPLETE)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tSTT = <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">\t\t<span class=\"type\">const</span> int32 result = JsonObject-&gt;<span class=\"built_in\">GetIntegerField</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;result&quot;</span>));</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\tFilePath = JsonObject-&gt;<span class=\"built_in\">GetStringField</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;file_path&quot;</span>));</span><br><span class=\"line\">\t\t<span class=\"type\">const</span> FString fileid = JsonObject-&gt;<span class=\"built_in\">GetStringField</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;file_id&quot;</span>));</span><br><span class=\"line\">\t\tFileUrl = fileid;</span><br><span class=\"line\">\t\t<span class=\"type\">const</span> FString msg = FString::<span class=\"built_in\">Printf</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;Upload Complete. URL=%s&quot;</span>), *FileUrl);</span><br><span class=\"line\">\t\t<span class=\"built_in\">SEND_MESSAGE</span>(msg)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (eventType == ITMG_MAIN_EVNET_TYPE_PTT_DOWNLOAD_COMPLETE)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tSTT = <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">\t\tFileUrl = <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">\t\t<span class=\"type\">const</span> int32 result = JsonObject-&gt;<span class=\"built_in\">GetIntegerField</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;result&quot;</span>));</span><br><span class=\"line\">\t\tFilePath = JsonObject-&gt;<span class=\"built_in\">GetStringField</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;file_path&quot;</span>));</span><br><span class=\"line\">\t\t<span class=\"type\">const</span> FString fileid = JsonObject-&gt;<span class=\"built_in\">GetStringField</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;file_id&quot;</span>));</span><br><span class=\"line\">\t\t<span class=\"type\">const</span> FString msg = FString::<span class=\"built_in\">Printf</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;download Complete. Path=%s&quot;</span>), *FilePath);</span><br><span class=\"line\">\t\t<span class=\"built_in\">SEND_MESSAGE</span>(msg)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (eventType == ITMG_MAIN_EVNET_TYPE_PTT_SPEECH2TEXT_COMPLETE)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"type\">const</span> int32 result = JsonObject-&gt;<span class=\"built_in\">GetIntegerField</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;result&quot;</span>));</span><br><span class=\"line\">\t\t<span class=\"type\">const</span> FString text = JsonObject-&gt;<span class=\"built_in\">GetStringField</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;text&quot;</span>));</span><br><span class=\"line\">\t\tSTT = text;</span><br><span class=\"line\">\t\t<span class=\"built_in\">UE_LOG</span>(LogTemp, Warning, <span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;Text == %s&quot;</span>), *text);</span><br><span class=\"line\">\t\t<span class=\"type\">const</span> FString fileid = JsonObject-&gt;<span class=\"built_in\">GetStringField</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;file_id&quot;</span>));</span><br><span class=\"line\">\t\t<span class=\"type\">const</span> FString msg = FString::<span class=\"built_in\">Printf</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;%s convert to %s&quot;</span>), *fileid, *text);</span><br><span class=\"line\">\t\t<span class=\"built_in\">UE_LOG</span>(LogTemp, Warning, <span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;%s&quot;</span>), *msg);</span><br><span class=\"line\">\t\t<span class=\"built_in\">SEND_MESSAGE</span>(msg)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (eventType == ITMG_MAIN_EVNET_TYPE_PTT_STREAMINGRECOGNITION_IS_RUNNING)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tint32 nResult = JsonObject-&gt;<span class=\"built_in\">GetIntegerField</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;result&quot;</span>));</span><br><span class=\"line\">\t\tFString text = JsonObject-&gt;<span class=\"built_in\">GetStringField</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;text&quot;</span>));</span><br><span class=\"line\">\t\tSTT = text;</span><br><span class=\"line\">\t\t<span class=\"built_in\">UE_LOG</span>(LogTemp, Warning, <span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;Streaming Text == %s&quot;</span>), *text);</span><br><span class=\"line\">\t\tFString fileid = <span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;STREAMINGRECOGNITION_IS_RUNNING&quot;</span>);</span><br><span class=\"line\">\t\tFString file_path = JsonObject-&gt;<span class=\"built_in\">GetStringField</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;file_path&quot;</span>));</span><br><span class=\"line\">\t\t<span class=\"type\">const</span> FString msg = FString::<span class=\"built_in\">Printf</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;%s convert to %s&quot;</span>), *fileid, *text);</span><br><span class=\"line\">\t\t<span class=\"built_in\">UE_LOG</span>(LogTemp, Warning, <span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;%s&quot;</span>), *msg);</span><br><span class=\"line\">\t\t<span class=\"built_in\">SEND_MESSAGE</span>(STT)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (eventType == ITMG_MAIN_EVNET_TYPE_PTT_STREAMINGRECOGNITION_COMPLETE)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tint32 nResult = JsonObject-&gt;<span class=\"built_in\">GetIntegerField</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;result&quot;</span>));</span><br><span class=\"line\">\t\tFString text = JsonObject-&gt;<span class=\"built_in\">GetStringField</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;text&quot;</span>));</span><br><span class=\"line\">\t\tSTT = text;</span><br><span class=\"line\">\t\t<span class=\"built_in\">UE_LOG</span>(LogTemp, Warning, <span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;Streaming Completed Text == %s&quot;</span>), *text);</span><br><span class=\"line\">\t\tFString fileid = JsonObject-&gt;<span class=\"built_in\">GetStringField</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;file_id&quot;</span>));</span><br><span class=\"line\">\t\tFString file_path = JsonObject-&gt;<span class=\"built_in\">GetStringField</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;file_path&quot;</span>));</span><br><span class=\"line\">\t\t<span class=\"type\">const</span> FString msg = FString::<span class=\"built_in\">Printf</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;%s convert to %s&quot;</span>), *fileid, *text);</span><br><span class=\"line\">\t\t<span class=\"built_in\">UE_LOG</span>(LogTemp, Warning, <span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;%s&quot;</span>), *msg);</span><br><span class=\"line\">\t\t<span class=\"built_in\">SEND_MESSAGE</span>(STT)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">endif</span></span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">GMEAudioAdpter::SetMessageHandler</span><span class=\"params\">(ITMGMessage* handler)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tMessageHandler = handler;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">GMEAudioAdpter::SetUserID</span><span class=\"params\">(<span class=\"type\">const</span> FString&amp; pUserID)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tUserID = pUserID;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">GMEAudioAdpter::StartRecord</span><span class=\"params\">()</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">GetAudioCtrl</span>()-&gt;<span class=\"built_in\">EnableMic</span>(<span class=\"literal\">true</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">GetAudioCtrl</span>()-&gt;<span class=\"built_in\">EnableSpeaker</span>(<span class=\"literal\">true</span>);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"type\">const</span> FString path = <span class=\"built_in\">GetFilePath</span>() + <span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;/unreal_ptt_local.file&quot;</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">GetPTT</span>()-&gt;<span class=\"built_in\">StartRecording</span>(<span class=\"built_in\">TCHAR_TO_UTF8</span>(*path));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">GMEAudioAdpter::StartRecordingWithStreaming</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">GetPTT</span>()-&gt;<span class=\"built_in\">StartRecordingWithStreamingRecognition</span>(<span class=\"built_in\">TCHAR_TO_UTF8</span>(*FilePath));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">GMEAudioAdpter::StopRecord</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">GetPTT</span>()-&gt;<span class=\"built_in\">StopRecording</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">GMEAudioAdpter::CancelRecord</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">GetPTT</span>()-&gt;<span class=\"built_in\">CancelRecording</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">GMEAudioAdpter::Upload</span><span class=\"params\">()</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">GetPTT</span>()-&gt;<span class=\"built_in\">UploadRecordedFile</span>(<span class=\"built_in\">TCHAR_TO_UTF8</span>(*FilePath));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">GMEAudioAdpter::Download</span><span class=\"params\">()</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">const</span> FString path = <span class=\"built_in\">GetFilePath</span>() + <span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;/unreal_ptt_downloadl.file&quot;</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">GetPTT</span>()-&gt;<span class=\"built_in\">DownloadRecordedFile</span>(<span class=\"built_in\">TCHAR_TO_UTF8</span>(*FileUrl),<span class=\"built_in\">TCHAR_TO_UTF8</span>(*path));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">GMEAudioAdpter::Play</span><span class=\"params\">()</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">GetPTT</span>()-&gt;<span class=\"built_in\">PlayRecordedFile</span>(<span class=\"built_in\">TCHAR_TO_UTF8</span>(*FilePath));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">GMEAudioAdpter::ConvertToText</span><span class=\"params\">()</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">GetPTT</span>()-&gt;<span class=\"built_in\">SpeechToText</span>(<span class=\"built_in\">TCHAR_TO_UTF8</span>(*FileUrl));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">GMEAudioAdpter::InitGME</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">SetAdvanceParams</span>(<span class=\"string\">&quot;DisableEncryptLog&quot;</span>,<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">SetAppVersion</span>(<span class=\"string\">&quot;fangh.space&quot;</span>);\t\t<span class=\"comment\">// Just For Test</span></span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"meta\">#<span class=\"keyword\">ifdef</span> __NX__</span></span><br><span class=\"line\">\t<span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">SetLogPath</span>(<span class=\"string\">&quot;gme_log_cache:/GME&quot;</span>);</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">else</span></span></span><br><span class=\"line\">\tFString logDir = FPaths::<span class=\"built_in\">ProjectSavedDir</span>();</span><br><span class=\"line\">\t<span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">SetLogPath</span>(<span class=\"built_in\">TCHAR_TO_UTF8</span>(*logDir));</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">endif</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"type\">const</span> std::string sdkAppId = <span class=\"built_in\">TCHAR_TO_UTF8</span>(*SdkAppID);</span><br><span class=\"line\">\t<span class=\"type\">const</span> std::string sdkAppKey = <span class=\"built_in\">TCHAR_TO_UTF8</span>(*SdkAppKey);</span><br><span class=\"line\">\t<span class=\"type\">const</span> <span class=\"type\">int</span> nAppid = <span class=\"built_in\">atoi</span>(sdkAppId.<span class=\"built_in\">c_str</span>());</span><br><span class=\"line\">\t<span class=\"comment\">//const char* userId = TCHAR_TO_UTF8(*UserID);</span></span><br><span class=\"line\">\t<span class=\"type\">const</span> <span class=\"type\">int</span> ret = <span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">Init</span>(sdkAppId.<span class=\"built_in\">c_str</span>(), <span class=\"built_in\">TCHAR_TO_UTF8</span>(*UserID));</span><br><span class=\"line\">\t<span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">SetTMGDelegate</span>(<span class=\"keyword\">this</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"type\">const</span> <span class=\"type\">int</span> RetCode = (<span class=\"type\">int</span>) <span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">CheckMicPermission</span>();</span><br><span class=\"line\">\t<span class=\"type\">const</span> FString msg = FString::<span class=\"built_in\">Printf</span>(<span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;check Permission retcode =%d&quot;</span>), RetCode);</span><br><span class=\"line\">\tGEngine-&gt;<span class=\"built_in\">AddOnScreenDebugMessage</span>(INDEX_NONE, <span class=\"number\">10.0f</span>, FColor::Yellow, *msg);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">constexpr</span> <span class=\"type\">char</span> strSig[<span class=\"number\">128</span>] = &#123;<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">\t<span class=\"type\">unsigned</span> <span class=\"type\">int</span> nLength = <span class=\"number\">128</span>;</span><br><span class=\"line\">\tnLength = <span class=\"built_in\">QAVSDK_AuthBuffer_GenAuthBuffer</span>(nAppid, <span class=\"string\">&quot;0&quot;</span>, <span class=\"built_in\">TCHAR_TO_UTF8</span>(*UserID), sdkAppKey.<span class=\"built_in\">c_str</span>(), (<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *)strSig, nLength);</span><br><span class=\"line\">\t<span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">GetPTT</span>()-&gt;<span class=\"built_in\">ApplyPTTAuthbuffer</span>(strSig, nLength);</span><br><span class=\"line\">\t<span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">SetAdvanceParams</span>(<span class=\"string\">&quot;ForceHighQuanlityState&quot;</span>,<span class=\"string\">&quot;0&quot;</span>);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">GetAudioCtrl</span>()-&gt;<span class=\"built_in\">EnableMic</span>(<span class=\"literal\">true</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">GetAudioCtrl</span>()-&gt;<span class=\"built_in\">EnableSpeaker</span>(<span class=\"literal\">true</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">SetAdvanceParams</span>(<span class=\"string\">&quot;SetStreamingRecTimeOut&quot;</span>,<span class=\"string\">&quot;5&quot;</span>);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> ret;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">GMEAudioAdpter::UnInit</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">Uninit</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">GMEAudioAdpter::OnTickGME</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">ITMGContextGetInstance</span>()-&gt;<span class=\"built_in\">Poll</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">FString <span class=\"title\">GMEAudioAdpter::GetFilePath</span><span class=\"params\">()</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">if</span> PLATFORM_ANDROID</span></span><br><span class=\"line\">\t<span class=\"keyword\">extern</span> FString GExternalFilePath;</span><br><span class=\"line\">\tFString path = GExternalFilePath + <span class=\"built_in\">FString</span>(<span class=\"string\">&quot;/&quot;</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> path;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">elif</span> PLATFORM_IOS</span></span><br><span class=\"line\">\t<span class=\"type\">char</span> buffer[<span class=\"number\">256</span>]=&#123;<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">\t<span class=\"built_in\">snprintf</span>(buffer, <span class=\"built_in\">sizeof</span>(buffer), <span class=\"string\">&quot;%s%s&quot;</span>, <span class=\"built_in\">getenv</span>(<span class=\"string\">&quot;HOME&quot;</span>),<span class=\"string\">&quot;/Documents/&quot;</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> buffer;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">endif</span></span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> FPaths::<span class=\"built_in\">ProjectSavedDir</span>();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"2-UE接口\"><a href=\"#2-UE接口\" class=\"headerlink\" title=\"2. UE接口\"></a>2. UE接口</h3><p><code>TencentSTT_Subsystem.h</code></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">pragma</span> once</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;CoreMinimal.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;Subsystems/GameInstanceSubsystem.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;GMEAudioAdpter.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;Engine/EngineTypes.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;TimerManager.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;TencentSTT_Subsystem.generated.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">DECLARE_DYNAMIC_MULTICAST_DELEGATE_OneParam</span>(FMessageHandler, FString, Value);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">UCLASS</span>(Blueprintable)</span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">GMESDK_API</span> UTencentSTT_Subsystem : <span class=\"keyword\">public</span> UGameInstanceSubsystem, <span class=\"keyword\">public</span> ITMGMessage</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">GENERATED_BODY</span>()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">\t<span class=\"built_in\">UFUNCTION</span>(BlueprintCallable, Category=<span class=\"string\">&quot;FH|Tencent&quot;</span>)</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">InitSDK</span><span class=\"params\">(<span class=\"type\">const</span> FString&amp; AppID)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"built_in\">UFUNCTION</span>(BlueprintCallable, Category=<span class=\"string\">&quot;FH|Tencent&quot;</span>)</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">StartListening</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"built_in\">UFUNCTION</span>()</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">OnTimer</span><span class=\"params\">()</span> <span class=\"type\">const</span></span>;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">\t<span class=\"built_in\">UPROPERTY</span>(BlueprintAssignable)</span><br><span class=\"line\">\tFMessageHandler MessageHandler;</span><br><span class=\"line\"><span class=\"keyword\">private</span>:</span><br><span class=\"line\">\tFTimerHandle TimerHandle;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">virtual</span> <span class=\"type\">void</span> <span class=\"title\">Deinitialize</span><span class=\"params\">()</span> <span class=\"keyword\">override</span></span>;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">virtual</span> <span class=\"type\">void</span> <span class=\"title\">OnMessage</span><span class=\"params\">(<span class=\"type\">const</span> FString&amp; message)</span> <span class=\"keyword\">override</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"built_in\">UFUNCTION</span>(BlueprintCallable, Category=<span class=\"string\">&quot;FH|Tencent&quot;</span>)</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">SetUserID</span><span class=\"params\">(<span class=\"type\">const</span> FString&amp; pUserID)</span></span>;</span><br><span class=\"line\">\t<span class=\"built_in\">UFUNCTION</span>(BlueprintCallable, Category=<span class=\"string\">&quot;FH|Tencent&quot;</span>)</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">StartRecord</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">\t<span class=\"built_in\">UFUNCTION</span>(BlueprintCallable, Category=<span class=\"string\">&quot;FH|Tencent&quot;</span>)</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">StartRecordStreaming</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">\t<span class=\"built_in\">UFUNCTION</span>(BlueprintCallable, Category=<span class=\"string\">&quot;FH|Tencent&quot;</span>)</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">StopRecord</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">\t<span class=\"built_in\">UFUNCTION</span>(BlueprintCallable, Category=<span class=\"string\">&quot;FH|Tencent&quot;</span>)</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">CancelRecord</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">\t<span class=\"built_in\">UFUNCTION</span>(BlueprintCallable, Category=<span class=\"string\">&quot;FH|Tencent&quot;</span>)</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">Upload</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">\t<span class=\"built_in\">UFUNCTION</span>(BlueprintCallable, Category=<span class=\"string\">&quot;FH|Tencent&quot;</span>)</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">Download</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">\t<span class=\"built_in\">UFUNCTION</span>(BlueprintCallable, Category=<span class=\"string\">&quot;FH|Tencent&quot;</span>)</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">Play</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">\t<span class=\"built_in\">UFUNCTION</span>(BlueprintCallable, Category=<span class=\"string\">&quot;FH|Tencent&quot;</span>)</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">ConvertToText</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">\t<span class=\"built_in\">UFUNCTION</span>(BlueprintCallable, Category=<span class=\"string\">&quot;FH|Tencent&quot;</span>)</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">InitGME</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">\t<span class=\"built_in\">UFUNCTION</span>()</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">OnTickGME</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">\t<span class=\"built_in\">UPROPERTY</span>(BlueprintAssignable)</span><br><span class=\"line\">\tFMessageHandler TXMessageNotify;</span><br><span class=\"line\"><span class=\"keyword\">private</span>:</span><br><span class=\"line\">\tFString UserID;</span><br><span class=\"line\">\tFString FilePath;</span><br><span class=\"line\">\tFString FileUrl;</span><br><span class=\"line\">\tFTimerHandle TXTimerHandle;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">\t<span class=\"built_in\">UFUNCTION</span>(BlueprintPure, Category=<span class=\"string\">&quot;FH|Tencent&quot;</span>)</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">GetSTT</span><span class=\"params\">(FString&amp; STT)</span></span></span><br><span class=\"line\"><span class=\"function\">\t</span>&#123;</span><br><span class=\"line\">\t\tSTT = GMEAudioAdpter::<span class=\"built_in\">Get</span>()-&gt;STT;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"built_in\">UFUNCTION</span>(BlueprintCallable, Category=<span class=\"string\">&quot;FH|Tencent&quot;</span>)</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">SetSdkIdAndKey</span><span class=\"params\">(<span class=\"type\">const</span> FString&amp; ID, <span class=\"type\">const</span> FString&amp; Key)</span></span></span><br><span class=\"line\"><span class=\"function\">\t</span>&#123;</span><br><span class=\"line\">\t\tGMEAudioAdpter::<span class=\"built_in\">Get</span>()-&gt;SdkAppID = ID;</span><br><span class=\"line\">\t\tGMEAudioAdpter::<span class=\"built_in\">Get</span>()-&gt;SdkAppKey = Key;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"built_in\">UFUNCTION</span>(BlueprintPure, Category=<span class=\"string\">&quot;FH|Tencent|Utils&quot;</span>)</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"type\">static</span> <span class=\"title\">UPARAM</span><span class=\"params\">(Displayname=<span class=\"string\">&quot;ResultStr&quot;</span>)</span> FString <span class=\"title\">FixSTT_TrimAndChop</span><span class=\"params\">(<span class=\"type\">const</span> FString&amp; OriginStr, <span class=\"type\">const</span> int32 Count = <span class=\"number\">1</span>)</span></span>;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n\n\n<p><code>TencentSTT_Subsystem.cpp</code></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;TencentSTT_Subsystem.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;XFAdpter.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;Engine/World.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;Kismet/KismetStringLibrary.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">UTencentSTT_Subsystem::InitSDK</span><span class=\"params\">(<span class=\"type\">const</span> FString&amp; AppID)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">if</span> PLATFORM_ANDROID</span></span><br><span class=\"line\">\tXFAdpter::<span class=\"built_in\">InitSDK</span>(AppID);</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">endif</span></span></span><br><span class=\"line\">\t<span class=\"built_in\">GetWorld</span>()-&gt;<span class=\"built_in\">GetTimerManager</span>().<span class=\"built_in\">SetTimer</span>(TimerHandle, <span class=\"keyword\">this</span>, &amp;UTencentSTT_Subsystem::OnTimer, <span class=\"number\">0.1</span>, <span class=\"literal\">true</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">UTencentSTT_Subsystem::StartListening</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">if</span> PLATFORM_ANDROID</span></span><br><span class=\"line\">\tXFAdpter::<span class=\"built_in\">StartListening</span>();</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">endif</span></span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">UTencentSTT_Subsystem::OnTimer</span><span class=\"params\">()</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (XFAdpter::CurrentMessage == <span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;&quot;</span>))</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tMessageHandler.<span class=\"built_in\">Broadcast</span>(XFAdpter::CurrentMessage);</span><br><span class=\"line\">\tXFAdpter::CurrentMessage = <span class=\"built_in\">TEXT</span>(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">UTencentSTT_Subsystem::Deinitialize</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tGMEAudioAdpter::<span class=\"built_in\">Get</span>()-&gt;<span class=\"built_in\">UnInit</span>();</span><br><span class=\"line\">\tSuper::<span class=\"built_in\">Deinitialize</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">UTencentSTT_Subsystem::OnMessage</span><span class=\"params\">(<span class=\"type\">const</span> FString&amp; message)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tTXMessageNotify.<span class=\"built_in\">Broadcast</span>(message);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">UTencentSTT_Subsystem::SetUserID</span><span class=\"params\">(<span class=\"type\">const</span> FString&amp; pUserID)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tGMEAudioAdpter::<span class=\"built_in\">Get</span>()-&gt;<span class=\"built_in\">SetUserID</span>(pUserID);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">UTencentSTT_Subsystem::StartRecord</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tGMEAudioAdpter::<span class=\"built_in\">Get</span>()-&gt;<span class=\"built_in\">StartRecord</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">UTencentSTT_Subsystem::StartRecordStreaming</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tGMEAudioAdpter::<span class=\"built_in\">Get</span>()-&gt;<span class=\"built_in\">StartRecordingWithStreaming</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">UTencentSTT_Subsystem::StopRecord</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tGMEAudioAdpter::<span class=\"built_in\">Get</span>()-&gt;<span class=\"built_in\">StopRecord</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">UTencentSTT_Subsystem::CancelRecord</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tGMEAudioAdpter::<span class=\"built_in\">Get</span>()-&gt;<span class=\"built_in\">CancelRecord</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">UTencentSTT_Subsystem::Upload</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tGMEAudioAdpter::<span class=\"built_in\">Get</span>()-&gt;<span class=\"built_in\">Upload</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">UTencentSTT_Subsystem::Download</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tGMEAudioAdpter::<span class=\"built_in\">Get</span>()-&gt;<span class=\"built_in\">Download</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">UTencentSTT_Subsystem::Play</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tGMEAudioAdpter::<span class=\"built_in\">Get</span>()-&gt;<span class=\"built_in\">Play</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">UTencentSTT_Subsystem::ConvertToText</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tGMEAudioAdpter::<span class=\"built_in\">Get</span>()-&gt;<span class=\"built_in\">ConvertToText</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">UTencentSTT_Subsystem::InitGME</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tGMEAudioAdpter::<span class=\"built_in\">Get</span>()-&gt;<span class=\"built_in\">SetMessageHandler</span>(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">GetWorld</span>()-&gt;<span class=\"built_in\">GetTimerManager</span>().<span class=\"built_in\">SetTimer</span>(TXTimerHandle, <span class=\"keyword\">this</span>, &amp;UTencentSTT_Subsystem::OnTickGME, <span class=\"number\">0.2</span>, <span class=\"literal\">true</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> GMEAudioAdpter::<span class=\"built_in\">Get</span>()-&gt;<span class=\"built_in\">InitGME</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">UTencentSTT_Subsystem::OnTickGME</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tGMEAudioAdpter::<span class=\"built_in\">Get</span>()-&gt;<span class=\"built_in\">OnTickGME</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">FString <span class=\"title\">UTencentSTT_Subsystem::FixSTT_TrimAndChop</span><span class=\"params\">(<span class=\"type\">const</span> FString&amp; OriginStr, <span class=\"type\">const</span> int32 Count)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> UKismetStringLibrary::<span class=\"built_in\">LeftChop</span>(UKismetStringLibrary::<span class=\"built_in\">TrimTrailing</span>(UKismetStringLibrary::<span class=\"built_in\">Trim</span>(OriginStr)), Count);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","text":"UE5腾讯语音插件[toc] 0. github里面动态库太大了，暂时没传github； 腾讯语音 https://www.alipan.com/s/YQ8AJ...","permalink":"/post/7_22_UE5腾讯语音插件","photos":[],"count_time":{"symbolsCount":"16k","symbolsTime":"14 mins."},"categories":[{"name":"UnrealEngine","slug":"UnrealEngine","count":23,"path":"api/categories/UnrealEngine.json"},{"name":"Plugin","slug":"UnrealEngine/Plugin","count":8,"path":"api/categories/UnrealEngine/Plugin.json"}],"tags":[{"name":"UnrealEngine","slug":"UnrealEngine","count":23,"path":"api/tags/UnrealEngine.json"},{"name":"Plugin","slug":"Plugin","count":10,"path":"api/tags/Plugin.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#UE5%E8%85%BE%E8%AE%AF%E8%AF%AD%E9%9F%B3%E6%8F%92%E4%BB%B6\"><span class=\"toc-text\">UE5腾讯语音插件</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0-github\"><span class=\"toc-text\">0. github</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-SDK%E6%8E%A5%E5%8F%A3\"><span class=\"toc-text\">1. SDK接口</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-UE%E6%8E%A5%E5%8F%A3\"><span class=\"toc-text\">2. UE接口</span></a></li></ol></li></ol></li></ol>","author":{"name":"FangH","slug":"blog-author","avatar":"/img/fh.png","link":"/","description":"我曾惊鸿一瞥未来","socials":{"github":"https://github.com/FHangH","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/zi-heng-18-99-47","csdn":"https://blog.csdn.net/weixin_44519692?spm=1000.2115.3001.5343","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"UE4 RPC","uid":"01b2c0831f95e39e5fd56ec4f69b86cb","slug":"7_04_UE4_RPC","date":"2022-10-06T07:28:25.953Z","updated":"2023-01-10T01:10:19.445Z","comments":true,"path":"api/articles/7_04_UE4_RPC.json","keywords":null,"cover":"https://cdn.jsdelivr.net/gh/FHangH/FHangBlogCDN_03@master/Aurora_ (20).webp","text":"UE4 RPC[toc] 1. RPC 架构1.1 架构简介 一个服务器， 一个或多个客户端 不能信任客户端，所有重要信息都需要通过服务器验证 Listen S...","permalink":"/post/7_04_UE4_RPC","photos":[],"count_time":{"symbolsCount":"4.7k","symbolsTime":"4 mins."},"categories":[{"name":"UnrealEngine","slug":"UnrealEngine","count":23,"path":"api/categories/UnrealEngine.json"}],"tags":[{"name":"UnrealEngine","slug":"UnrealEngine","count":23,"path":"api/tags/UnrealEngine.json"}],"author":{"name":"FangH","slug":"blog-author","avatar":"/img/fh.png","link":"/","description":"我曾惊鸿一瞥未来","socials":{"github":"https://github.com/FHangH","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/zi-heng-18-99-47","csdn":"https://blog.csdn.net/weixin_44519692?spm=1000.2115.3001.5343","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"UE5字符匹配插件","uid":"f52313d227afc03c4ee84d484027810d","slug":"7_21_UE5字符匹配插件","date":"2024-02-29T06:19:33.437Z","updated":"2024-02-29T06:18:48.328Z","comments":true,"path":"api/articles/7_21_UE5字符匹配插件.json","keywords":null,"cover":"https://cdn.jsdelivr.net/gh/FHangH/FHangBlogCDN_03@master/Aurora_ (43).webp","text":"UE5字符匹配插件[toc] 0. githubUE5字符匹配插件 1. 功能介绍1.1 字符匹配 支持莱温斯特编辑距离和Jaccard两种字符匹配算法 正常情...","permalink":"/post/7_21_UE5字符匹配插件","photos":[],"count_time":{"symbolsCount":"5.7k","symbolsTime":"5 mins."},"categories":[{"name":"UnrealEngine","slug":"UnrealEngine","count":23,"path":"api/categories/UnrealEngine.json"},{"name":"Plugin","slug":"UnrealEngine/Plugin","count":8,"path":"api/categories/UnrealEngine/Plugin.json"}],"tags":[{"name":"UnrealEngine","slug":"UnrealEngine","count":23,"path":"api/tags/UnrealEngine.json"},{"name":"Plugin","slug":"Plugin","count":10,"path":"api/tags/Plugin.json"}],"author":{"name":"FangH","slug":"blog-author","avatar":"/img/fh.png","link":"/","description":"我曾惊鸿一瞥未来","socials":{"github":"https://github.com/FHangH","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/zi-heng-18-99-47","csdn":"https://blog.csdn.net/weixin_44519692?spm=1000.2115.3001.5343","juejin":"","customs":{}}}}}